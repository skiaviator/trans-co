<!DOCTYPE html>
    <html>
<meta charset="UTF-8">
<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<body>
<link rel="stylesheet" href="/api/api.main/adds/style.css">
    <div id="webpage">
        <div id= "left"> <img src="/api/api.main/adds/123.png" style="width: 240px; height: 120px;"/></div>
        <div id="up">

            <ul>
                <h1>Firma transportowa "SuperLion" Sp. z o. o.</h1>
                <li><a href="manage_workers.html">ZARZĄDZAJ KLIENTAMI</a></li>
                <li><a href="#">ZARZĄDZAJ TRASAMI</a></li> 
<!--                <li><a href="manage_presents.html">ZARZĄDAJ NAGRODAMI</a></li> -->
<!--                <li><a href="manage_secretariat_calendar.html">ZARZĄDZAJ GRAFIKIEM SEKRETARIATU</a></li> -->
<!--                <li><a href="manage_drivers_calendar.html">ZARZĄDZAJ GRAFIKIEM KIEROWCÓW</a></li> -->
<!--                <li><a href="reservacion_place_for_client.html">ZAREZERWUJ MIEJSCE DLA KLIENTA</a></li>-->
<!--                <li><a href="manage_buses.html">ZARZĄDZAJ POJAZDAMI</a></li>  -->
                <li><a href="http://localhost:63342/api/api.main/frontend/niezalogowany/contact.html">WYLOGUJ SIĘ</a></li>
            </ul>
         </div>
         <div id="description">
             <h2>Poniżej podano aktualne trasy:</h2>
             <pre id="change" onclick="get_routes()"> Kliknij tutaj, aby wyświetlić aktualne trasy </pre>
             <script>
                 // pobieranie tras
                 let stat =
                     {
                         fee: 0,
                         id: 0,
                         reservation: [],
                         routeName: "",
                         routeStops: []
                     };
                 var odp;
                 async function get_routes()
                 {
                     await axios.get('http://localhost:8080/routes')
                         .then((response) => {
                             console.log(response.data);
                             console.log(response.status);
                             stat = response.data;

                             let numer = JSON.stringify(Object.keys(stat));
                             //alert(numer.substr((numer.lastIndexOf("]")-2),1));
                             let newNumber = numer.substr((numer.lastIndexOf("]")-2),1) //numer ostatniego dto
                             let dane = []; //tablica na dane
                             let wypisz = "";
                             for (let i=0; i <parseInt(newNumber)+1; i++)
                             {
                                 odp = JSON.stringify(Object.entries(stat[i]));
                                 let fee  = odp.substring(odp.indexOf('fee')+5,odp.indexOf('routeName')-4);
                                 let routeName  = odp.substring(odp.indexOf('routeName')+12,odp.indexOf('reservation')-5);
                                 dane[i]=["ID: "+ (i+1)+". "+"Trasa: "+ routeName+". "+"Cena: "+fee+" zł."];
                                 wypisz += dane[i]+"\n";

                             }

                             if (wypisz=="")
                                 return document.getElementById("change").innerHTML = "Brak tras";
                             else
                                 return  document.getElementById("change").innerHTML = wypisz;
                             //   for (let i=0; i < parseInt(newNumber)+1; i++)
                             //   {

                             //       alert(dane[i]);
                             //   }

                         })
                         .catch((error) => {
                             alert('Wystąpił błąd!')
                         });


                 }
                 get_routes();
             </script>
         </div>


        <script>
            function add_route() {
                // dodawanie tras
                var trasa = document.getElementById('trasa').value;
                var cena = document.getElementById('cena').value;
                dane =
                    {

                        fee: cena,
                        routeName: trasa

                    }
                axios.post('http://localhost:8080/routes', JSON.stringify(dane), {headers: {'Content-Type': 'application/JSON'}})
                    .then((response) => {
                        console.log(response.data);
                        console.log(response.status)
                        stat = response.status;
                    })
                    .catch((error) => {
                        alert('Wystąpił błąd!')
                    });
            }
        </script>

                <div id = form1>
                    
                    <form action="manage_routes.html" method ="GET">  
                    <h4>Dodaj nową trasę do bazy:</h4>             
                    <label>Nazwa trasy:</label><br>
                    <input type="text" id="trasa"> <br>
                    <label >Cena(w złotych):</label><br>
                    <input type="number" id="cena"> <br><br>
                    <input type ="submit" id = "dodaj" value="Dodaj nową trasę" onclick="add_route();">
                    </form>
        </div>
    </div>
<!--                <div id = form1>-->
<!--                    <form action="manage_routes.html" method ="GET">-->
<!--                        <h4>Dodaj godziny odjazdu dla trasy:</h4>-->
<!--                        <label >Podaj identyfikator trasy z bazy:</label><br>-->
<!--                        <input type="number" id="id"> <br><br>-->
<!--                        <label >Odjazd:</label><br>-->
<!--                        <input type="time" id="arrival"> <br><br>-->
<!--                        <label >Przyjazd:</label><br>-->
<!--                        <input type="time" id="departure"> <br><br>-->
<!--                        <input type ="submit" id = "add_hour" value="Dodaj nową godzinę do trasy">-->
<!--                        </form>-->
<!--                    </div>-->
<!--                    <form action="manage_routes.html" method ="GET">-->
<!--                        <h4>Usuń godzinę odjazdu z trasy:</h4>-->
<!--                        <label >Podaj identyfikator trasy z bazy:</label><br>-->
<!--                        <input type="number" id="id"> <br><br>-->
<!--                        <label >Podaj godzinę odjazdu, którą chcesz zmienić:</label><br>-->
<!--                        <input type="time" id="oldarrival"> <br><br>-->
<!--                        <label >Podaj nową godzinę odjazdu:</label><br>-->
<!--                        <input type="time" id="newarrival"> <br><br>-->
<!--                        <label >Podaj nową godzinę przyjazdu:</label><br>-->
<!--                        <input type="time" id="newdeparture"> <br><br>-->
<!--                        <input type ="submit" id = "usun" value="Usuń godzinę odjazdu z bazy">-->
<!--                        </form>-->

<!--                        <form action="manage_routes.html" method ="GET">-->
<!--                            <h4>Usuń trasę:</h4>-->
<!--                            <label >Podaj identyfikator trasy z bazy:</label><br>-->
<!--                            <input type="number" id="id"> <br><br>-->
<!--                            <input type ="submit" id = "usun" value="Usuń trasę z bazy">-->
<!--                            </form>-->
    </body>
    </html>